1 'SAVE "MENU.BAS"
10 CLEAR ,&H8FFF:DEFINT A-Z:CLS:POKE &HE3FF,50:POKE &HD456,1:POKE &H92DC,3:POKE &HE3FE,0
1000 CN=0:Y=8:GOSUB 5600:CMD SCREEN 1:LINE (60,17)-(326,46),6,BF
1010 LINE (64,19)-(322,44),5,BF
1020 LINE (68,20)-(318,42),1,BF
1030 LINE (230,62)-(560,156+Y),6,BF
1040 LINE (234,64)-(556,154+Y),5,BF
1050 LINE (238,66)-(552,152+Y),1,BF
1060 POKE &H9088,0:POKE &H9089,0
1190 BM$="ＭＩＲＲＯＲＳ　ＭＥＮＵ":CMD WIDTH &HC78C,&H80,7:CMD KANJI BM$
1195 YY=&HD835:ISET X:
1200 BM$="Start new game":CMD WIDTH YY,&H80,7:CMD KANJI BM$:YY=YY+&H50*20
1210 BM$="Load saved game":CMD WIDTH YY,&H80,7:CMD KANJI BM$:YY=YY+&H50*20
1214 BM$="Clear all saves":CMD WIDTH YY,&H80,7:CMD KANJI BM$:YY=YY+&H50*20
1215 BM$="Settings":CMD WIDTH YY,&H80,7:CMD KANJI BM$:YY=YY+&H50*20
1216 BM$="Select with the [8] and [2] keys, and press Return to confirm.":CMD WIDTH &HF70A,&H80,7:CMD KANJI BM$
1217 GOSUB 5620
1220 CM=4:GOSUB 5400
1230 IF CN=1 THEN 1300
1240 IF CN=2 THEN 2000
1245 IF CN=3 THEN GOSUB 1260:GOTO 1000
1246 IF CN=4 THEN GOSUB 9000:GOTO 1000
1250 GOTO 1220
1254 '
1255 '
1260 GOSUB 5600:BM$="Please insert the Main disk in Drive 1.":GOSUB 4010:GOSUB 4000
1261 CMD SCREEN 1:GOSUB 5600:GOSUB 4250:BM$="All saved data will be erased. Continue? (Y/N)":CMD WIDTH &HD6D7,&H80,7:CMD KANJI BM$:GOSUB 5620
1262 S$=INKEY$:IF S$="" THEN 1262
1263 IF S$="n" OR S$="N" THEN GOTO 1260
1264 IF S$="y" OR S$="Y" THEN GOTO 1268
1265 GOTO 1262
1268 GOSUB 5600:BM$="Erasing saved data on disk in Drive 1...":GOSUB 4040:GOSUB 5620
1270 CMD FOR &H0
1285 GOSUB 5600:BM$="Erasing complete.":GOSUB 4040
1286 GOSUB 4000
1290 RETURN
1298 '
1299 '
1300 GOSUB 5600:BM$="Please insert a blank disk in Drive 1 and Drive 2.":GOSUB 4050:BM$="(or insert Main and Game disks to skip loading)":GOSUB 4060:GOSUB 4000
1301 CMD READ &H0,&H31,&H8,&H4000:CMD PEEK &H4000,A:CMD PEEK &H4001,B:CMD PEEK &H43FE,AA:CMD PEEK &H43FF,AB:SK=0
1302 IF A=ASC("I") AND B=ASC("P") AND AA=100 AND AB=101 THEN SK=1:GOTO 1312:ELSE 1304
1303 GOSUB 5600:BM$="All data in the disk in Drive 2 will be erased.":GOSUB 4050:GOTO 1305
1304 GOSUB 5600:BM$="All data in the disks in Drive 1 and Drive 2 will be erased.":GOSUB 4050
1305 BM$="Are you sure? (Y/N)":GOSUB 4060:GOSUB 5620
1306 S$=INKEY$:IF S$="" THEN 1306
1307 IF S$="n" OR S$="N" THEN GOTO 1300
1308 IF S$="y" OR S$="Y" THEN GOTO 1315
1309 GOTO 1306
1310 '
1311 '
1312 CMD READ &H1,&H31,&H8,&H4000:CMD PEEK &H4000,A:CMD PEEK &H4001,B:CMD READ &H1,&H96,&H1,&H4000:CMD PEEK &H4002,AA:CMD PEEK &H4003,AB
1313 IF A=ASC("I") AND B=ASC("P") AND AA=1 AND AB=201 THEN SK=2:GOTO 1500:ELSE 1303
1314 '
1315 IF SK=1 THEN 1400
1316 CMD READ &H00,&H4F,&H05,&H4000:CMD PEEK &H4000,A:CMD PEEK &H4001,B
1317 IF A=ASC("I") AND B=ASC("P") THEN 1370
1320 GOSUB 5600:BM$="Formatting disk in Drive 1...":GOSUB 4010:GOSUB 5620
1330 CMD FOR &H0:
1370 GOSUB 5600:BM$="Loading data on disk in Drive 1 from CD...":GOSUB 4040:GOSUB 5620
1380 COMMON COPY &H0,13414
1400 '
1405 CMD READ &H1,&H31,&H8,&H4000:CMD PEEK &H4000,A:CMD PEEK &H4001,B
1406 IF A=ASC("I") AND B=ASC("P") THEN 1450
1410 GOSUB 5600:BM$="Formatting disk in Drive 2...":GOSUB 4010:GOSUB 5620
1420 CMD FOR &H1:
1450 GOSUB 5600:BM$="Loading data on disk in Drive 2 from CD...":GOSUB 4040:GOSUB 5620
1480 COMMON COPY &H1,14030
1500 '
1510 POKE &H9088,0:CMD SET "A:":CMD READ &H0,&H31,&H8,&H4000:
1520 POKE &H43FE,100:POKE &H43FF,101
1530 CMD WRITE &H0,&H31,&H8,&H4000
1540 '
1550 POKE &H9089,0:CMD SET "B:":CMD READ &H1,&H31,&H8,&H4000:
1560 POKE &H43FE,0:POKE &H43FF,0
1570 CMD WRITE &H1,&H31,&H8,&H4000
1580 '
1600 GOSUB 5600:BM$="The disk in Drive 1 is the Main Disk.":GOSUB 4070:BM$="The disk in Drive 2 is the Game Disk.":GOSUB 4071
1700 BM$="Don't forget to write their names on them.":GOSUB 4080:GOSUB 4000
1900 '
1990 POKE &H92DC,1:CMD SET:GOSUB 5600:COLOR=(7,7):CMD SCREEN 0:CMD RUN "NO0"
1998 '
1999 '
2000 '
2010 GOSUB 5600:BM$="Please insert the Main disk in Drive 1.":GOSUB 4040:GOSUB 4000
2020 POKE &H9088,0:CMD SET "A:":CMD PEEK &HF3FE,AA:CMD PEEK &HF3FF,AB
2025 IF AA=100 AND AB=101 THEN 2030
2026 GOSUB 5600:BM$="The disk in Drive 1 is not the correct Main Disk.":GOSUB 4040:GOSUB 4000:GOTO 2010
2030 GOSUB 5600:BM$="Select save slot to load (1-9):":GOSUB 4020:SA=0:SB=0:GOSUB 4500
2031 S$=INKEY$:IF S$="" THEN 2031
2032 IF S$=CHR$(13) AND SA>0 THEN GOTO 2400
2033 IF S$=CHR$(27) THEN GOTO 1000
2035 T=VAL(S$):IF T>=1 AND T<=9 THEN 2040:ELSE 2031
2040 TU=&H31:TU=TU+T:CMD READ &H0,TU,&H1,&H3000:CMD PEEK &H3002,SA:CMD PEEK &H3003,SB:
2045 IF SA=0 AND SB=0 THEN 2050:ELSE 2200
2050 BM$=S$+": empty slot":GOSUB 4091:GOTO 2031
2199 '
2200 RESTORE 7000
2210 READ A,B,C,D,E$:IF A=99 THEN 2260
2220 IF A=SA AND B=SB THEN 2270
2250 GOTO 2210
2260 SA=0:SB=0:BM$=S$+": invalid data":GOSUB 4091:GOTO 2031
2270 BM$=S$+": saved "+E$:GOSUB 4091:GOTO 2031
2395 '
2400 GOSUB 5600:BM$="Insert the Game Disk in drive 2.":GOSUB 4040:GOSUB 4000
2450 '
3000 POKE &H9089,D:CMD SET "B:":CMD READ &H1,&H96,&H1,&H3000:
3001 CMD PEEK &H3002,SA:CMD PEEK &H3003,SB:
3010 IF SA=C AND SB=201 THEN 3900:
3015 '
3020 GOSUB 5600:BM$="The Game Disk in Drive 2 doesn't match the save file.":GOSUB 4090:BM$="Reload the correct data from CD? (Y/N)":GOSUB 4072:GOSUB 5620
3050 S$=INKEY$:IF S$="" THEN 3050
3060 IF S$="y" OR S$="Y" THEN 3100
3070 IF S$="n" OR S$="N" THEN 3090
3080 GOTO 3050
3090 GOSUB 5600:BM$="Please insert the Game Disk in Drive 2.":GOSUB 4040:GOSUB 4000:GOTO 3000
3099 '
3100 '
3101 CMD READ &H1,&H31,&H8,&H4000:CMD PEEK &H4000,A:CMD PEEK &H4001,B
3102 IF A=ASC("I") AND B=ASC("P") THEN 3120
3105 GOSUB 5600:BM$="The disk in Drive 2 will be formatted.":GOSUB 4010:GOSUB 5620
3110 CMD FOR &H1:
3120 '
3130 GOSUB 5600:BM$="Loading data on disk in Drive 2 from CD...":GOSUB 4040:GOSUB 5620
3398 '
3400 GOSUB 6000
3499 '
3500 '
3510 '
3520 '
3530 '
3540 '
3899 '
3900 '
3910 POKE &H92DC,1:POKE &H9089,D:CMD SET "B:":GOSUB 5600:COLOR=(7,7):CMD SCREEN 0:CMD RUN E$
3999 '
4000 CMD SCREEN 0:BM$="Once you are ready, please press Return.":CMD WIDTH &HF2B0,&H60,7:CMD KANJI BM$
4001 BM$="Press [ESC] to return to the menu.":CMD WIDTH &HF710,&H60,2:CMD KANJI BM$:GOSUB 5620
4006 S$=INKEY$:IF S$="" THEN 4006
4007 IF S$=CHR$(27) THEN RETURN 1000
4008 IF S$=CHR$(13) THEN GOSUB 5600:RETURN :ELSE 4006
4010 CMD SCREEN 1:GOSUB 4100:CMD WIDTH &HD6DF,&H60,7:CMD KANJI BM$:RETURN:'---1
4020 CMD SCREEN 1:GOSUB 4130:CMD WIDTH &HD6DF,&H60,7:CMD KANJI BM$:RETURN:'-2-1
4030 CMD WIDTH &HDD1F,&H60,7:CMD KANJI BM$:RETURN:'---2-2
4040 CMD SCREEN 1:GOSUB 4160:CMD WIDTH &HD6D9,&H60,7:CMD KANJI BM$:RETURN:'1
4050 CMD SCREEN 1:GOSUB 4130:CMD WIDTH &HD6DC,&H60,7:CMD KANJI BM$:RETURN:'-2-1
4060 CMD WIDTH &HDD1C,&H60,7:CMD KANJI BM$:RETURN
4070 CMD SCREEN 1:GOSUB 4190:CMD WIDTH &HCF0F,&H40,7:CMD KANJI BM$:RETURN:'-2-1
4071 CMD WIDTH &HD54F,&H40,7:CMD KANJI BM$:RETURN:'-2-1
4072 CMD WIDTH &HD54E,&H40,7:CMD KANJI BM$:RETURN:'-2-1
4080 CMD WIDTH &HDB8F,&H40,7:CMD KANJI BM$:RETURN
4081 CMD WIDTH &HE1CF,&H40,7:CMD KANJI BM$:RETURN
4090 CMD SCREEN 1:GOSUB 4220:CMD WIDTH &HCF0E,&H40,7:CMD KANJI BM$:RETURN:'-2-1
4091 GOSUB 4280:CMD WIDTH &HDD1F,&H40,7:CMD KANJI BM$:RETURN
4100 LINE (96,68)-(524,93),6,BF
4110 LINE (98,69)-(522,92),5,BF
4120 LINE (100,70)-(520,91),1,BF:RETURN
4130 LINE (76,68)-(554,114),6,BF
4140 LINE (78,69)-(552,113),5,BF
4150 LINE (80,70)-(550,112),1,BF:RETURN
4160 LINE (58,68)-(562,93),6,BF
4170 LINE (60,69)-(560,92),5,BF
4180 LINE (62,70)-(558,91),1,BF:RETURN
4190 LINE (76,36)-(544,130),6,BF
4200 LINE (78,37)-(542,129),5,BF
4210 LINE (80,38)-(540,128),1,BF:RETURN
4220 LINE (76,36)-(544,106),6,BF
4230 LINE (78,37)-(542,105),5,BF
4240 LINE (80,38)-(540,104),1,BF:RETURN
4250 LINE (48,68)-(585,93),6,BF
4260 LINE (50,69)-(583,92),5,BF
4270 LINE (52,70)-(581,91),1,BF:RETURN
4280 LINE (90,92)-(500,112),1,BF:RETURN
4500 BM$="Press Return after selecting a save slot.":CMD WIDTH &HF2B0,&H60,7:CMD KANJI BM$
4501 BM$="Press [ESC] to return to the menu.":CMD WIDTH &HF710,&H60,2:CMD KANJI BM$:GOSUB 5620:RETURN
4999 '
5400 '
5420 LINE(258,75+CN*20)-(530,94+CN*20),7,BF,XOR:CN2=CN
5430 I$=INKEY$:IF I$="" THEN 5430
5435 IF I$="8" THEN IF CN=0 THEN 5430 :ELSE CN=CN-1:GOTO 5440
5436 IF I$="2" THEN IF CN=CM-1 THEN 5430 :ELSE CN=CN+1
5440 LINE(258,75+CN2*20)-(530,94+CN2*20),7,BF,XOR
5450 IF I$=CHR$(13) THEN CN=CN+1:RETURN :ELSE 5420
5500 '
5600 CMD COLOR[F,0,0,0,0,0,0,0,0]:CLS 2:RETURN
5610 CMD COLOR[F,0,0,0,0,0,0,0,511]:RETURN
5620 CMD COLOR[F,0,&O101,&O552,&O333,&O444,&O333,&O666,&O777]:RETURN
5979 '
5998 '
5999 '                                                                          6000 ON F GOTO 6010,6020,6030,6040,6050,6060,6070,6080,6090,6100,6110,6120,6130,6140,6150,6160,6170,6180,6190,6200,6210,6220,6230,6240,6250,6260,6270,6280,6290,6300,6310,6340
6001 '
8900 DATA 99,99,99,99,99
8999 '
9000 '
9005 GOSUB 5600:CMD SCREEN 1
9010 LINE (96,68)-(524,93+40),6,BF
9020 LINE (98,69)-(522,92+40),5,BF
9030 LINE (100,70)-(520,91+40),1,BF
9040 BM$="CD Music Repeat:":CMD WIDTH &HD6DF,&H60,7:CMD KANJI BM$:BM$="ON     OFF":CMD WIDTH &HD6FF,&H60,7:CMD KANJI BM$
9050 BM$="Text Speed:":CMD WIDTH &HDD1F,&H60,7:CMD KANJI BM$:BM$="1 - 2 - 3":CMD WIDTH &HDD3F,&H60,7:CMD KANJI BM$
9060 BM$="Text Sound:":CMD WIDTH &HE35F,&H60,7:CMD KANJI BM$:BM$="FM    BEEP   OFF":CMD WIDTH &HE37C,&H60,7:CMD KANJI BM$
9100 CMD SCREEN 0:BM$="Select with [8]/[2], change with [4]/[6], confirm with Return.":CMD WIDTH &HF709,&H60,7:CMD KANJI BM$
9110 GOSUB 5620
9120 CN=0:CM=3:DX=0
9125 X1=PEEK(&HD456):IF X1=3 THEN X1=1 :ELSE X1=0
9126 V1=PEEK(&HE3FF):IF V1=0 THEN V1=2 :ELSE IF V1=50 THEN V1=1 :ELSE V1=150
9127 Z1=PEEK(&HE3FE)
9900 '8 / 2 ﾃﾞ ｾﾝﾀｸ
9910 GOSUB 10100:GOSUB 11100:GOSUB 11230
9920 LINE(96+16,72+CN*20)-(264,89+CN*20),7,BF,XOR:CN2=CN
9930 I$=INKEY$:IF I$="" THEN 9930
9935 IF I$="8" THEN GOSUB 12000:IF CN=0 THEN 9930 :ELSE CN=CN-1:GOTO 9940
9936 IF I$="2" THEN GOSUB 12010:IF CN=CM-1 THEN 9930 :ELSE CN=CN+1:GOTO 9940
9937 IF I$="4" THEN IF DX=0 THEN 10000 :ELSE IF DX=1 THEN 11000:ELSE IF DX=2 THEN 11210
9938 IF I$="6" THEN IF DX=0 THEN 10010 :ELSE IF DX=1 THEN 11010:ELSE IF DX=2 THEN 11220
9939 IF I$="Y" THEN POKE &HE00C,&HC9
9940 LINE(96+16,72+CN2*20)-(264,89+CN2*20),7,BF,XOR
9950 IF I$=CHR$(13) THEN 9970
9952 IF I$=CHR$(&H27) THEN RETURN
9960 GOTO 9920
9970 IF X1=1 THEN POKE &HD456,3 :ELSE POKE &HD456,1
9980 IF V1=2 THEN POKE &HE3FF,0 :ELSE IF V1=1 THEN POKE &HE3FF,50 :ELSE POKE &HE3FF,150
9970 POKE &HE3FE,Z1
9990 RETURN
9999 '
10000 IF X1=0 THEN 9930 :ELSE X1=X1-1:GOSUB 10110:GOSUB 10100:GOTO 9930
10010 IF X1=1 THEN 9930 :ELSE X1=X1+1:GOSUB 10110:GOSUB 10100:GOTO 9930
10100 LINE(368+X1*48,72)-(399+X1*48,89),7,BF,XOR:X2=X1:RETURN
10110 LINE(368+X2*48,72)-(399+X2*48,89),7,BF,XOR:RETURN
10119 '
11000 IF V1=0 THEN 9930 :ELSE V1=V1-1:GOSUB 11110:GOSUB 11100:GOTO 9930
11010 IF V1=2 THEN 9930 :ELSE V1=V1+1:GOSUB 11110:GOSUB 11100:GOTO 9930
11100 LINE(372+V1*26,72+20)-(385+V1*26,89+20),7,BF,XOR:V2=V1:RETURN
11110 LINE(372+V2*26,72+20)-(385+V2*26,89+20),7,BF,XOR:RETURN
11200 '
11210 IF Z1=0 THEN 9930 :ELSE Z1=Z1-1:GOSUB 11240:GOSUB 11230:GOTO 9930
11220 IF Z1=2 THEN 9930 :ELSE Z1=Z1+1:GOSUB 11240:GOSUB 11230:GOTO 9930
11230 LINE(336+Z1*48,72+40)-(383+Z1*48,89+40),7,BF,XOR:Z2=Z1:RETURN
11240 LINE(336+Z2*48,72+40)-(383+Z2*48,89+40),7,BF,XOR:RETURN
12000 IF DX>0 THEN DX=DX-1:RETURN
12010 IF DX<CM-1 THEN DX=DX+1:RETURN
